<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    

    <script>

     document.addEventListener("DOMContentLoaded", async function() {


        async function getData() {

let url = `https://docs.google.com/spreadsheets/d/e/2PACX-1vR8QGnw18GWlRF0u-eDaWixNtK2tpR5TQPFwhgo5dfKyz6NoUoxjsmeRiXU-J5v6A/pubhtml`;

    let result =  await fetch(url);
    if (!result.ok) {
        throw new Error(`Failed to fetch data. Status: ${response.status}`);
    }

    result = await result.text();
    let tempDiv = document.createElement('div');
    tempDiv.innerHTML = result;

    let tables = tempDiv.querySelectorAll("table");

    let all = [];
    tables.forEach(table => {
        
        let data =  [];
        table.querySelectorAll('tbody tr').forEach((row,key) => {
            let single = [];
            row.querySelectorAll('td').forEach(col => {     
                single.push(col.innerHTML);
            });
            data.push(single);       
        });
        
        all.push(data);
    });

    return all;

}


           console.log('====================================');
           console.log(await getData());
           console.log('====================================');

        

     });








    </script>
</body>
</html>